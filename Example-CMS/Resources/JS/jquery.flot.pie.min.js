(function(n){function r(r){function g(n,t){t.series.pie.show&&(t.grid.show=!1,t.series.pie.label.show=="auto"&&(t.series.pie.label.show=t.legend.show?!1:!0),t.series.pie.radius=="auto"&&(t.series.pie.radius=t.series.pie.label.show?3/4:1),t.series.pie.tilt>1&&(t.series.pie.tilt=1),t.series.pie.tilt<0&&(t.series.pie.tilt=0),n.hooks.processDatapoints.push(it),n.hooks.drawOverlay.push(vt),n.hooks.draw.push(et))}function nt(n,t){var i=n.getOptions();i.series.pie.show&&i.grid.hoverable&&t.unbind("mousemove").mousemove(ht);i.series.pie.show&&i.grid.clickable&&t.unbind("click").click(ct)}function tt(n){for(var i,t=0;t<n.length;++t)i=parseFloat(n[t].data[0][1]),i&&(c+=i)}function it(i){p||(p=!0,o=i.getCanvas(),s=n(o).parent(),t=i.getOptions(),i.setData(ft(i.getData())))}function rt(){var i=r.getPlaceholder(),n=i.width(),e=i.height();a=s.children().filter(".legend").children().width();f=Math.min(n,e/t.series.pie.tilt)/2;h=e/2+t.series.pie.offset.top;u=n/2;t.series.pie.offset.left=="auto"?t.legend.position.match("w")?u+=a/2:u-=a/2:u+=t.series.pie.offset.left;u<f?u=f:u>n-f&&(u=n-f)}function ut(n){for(var t=0;t<n.length;++t)typeof n[t].data=="number"?n[t].data=[[1,n[t].data]]:(typeof n[t].data=="undefined"||typeof n[t].data[0]=="undefined")&&(typeof n[t].data!="undefined"&&typeof n[t].data.label!="undefined"&&(n[t].label=n[t].data.label),n[t].data=[[1,0]]);return n}function ft(n){var i;n=ut(n);tt(n);var r=0,e=0,u=t.series.pie.combine.color,f=[];for(i=0;i<n.length;++i)n[i].data[0][1]=parseFloat(n[i].data[0][1]),n[i].data[0][1]||(n[i].data[0][1]=0),n[i].data[0][1]/c<=t.series.pie.combine.threshold?(r+=n[i].data[0][1],e++,u||(u=n[i].color)):f.push({data:[[1,n[i].data[0][1]]],color:n[i].color,label:n[i].label,angle:n[i].data[0][1]*Math.PI*2/c,percent:n[i].data[0][1]/c*100});return e>0&&f.push({data:[[1,r]],color:u,label:t.series.pie.combine.label,angle:r*Math.PI*2/c,percent:r/c*100}),f}function et(i,r){function a(){ctx.clearRect(0,0,o.width,o.height);s.children().filter(".pieLabel, .pieLabelBackground").remove()}function y(){var r=5,e=15,s=10,n,i;if(n=t.series.pie.radius>1?t.series.pie.radius:f*t.series.pie.radius,!(n>=o.width/2-r)&&!(n*t.series.pie.tilt>=o.height/2-e)&&!(n<=s)){for(ctx.save(),ctx.translate(r,e),ctx.globalAlpha=.02,ctx.fillStyle="#000",ctx.translate(u,h),ctx.scale(1,t.series.pie.tilt),i=1;i<=s;i++)ctx.beginPath(),ctx.arc(0,0,n,0,Math.PI*2,!1),ctx.fill(),n-=i;ctx.restore()}}function p(){function a(t,i,u){t<=0||(u?ctx.fillStyle=i:(ctx.strokeStyle=i,ctx.lineJoin="round"),ctx.beginPath(),Math.abs(t-Math.PI*2)>1e-9?ctx.moveTo(0,0):n.browser.msie&&(t-=.0001),ctx.arc(0,0,c,r,r+t,!1),ctx.closePath(),r+=t,u?ctx.fill():ctx.stroke())}function v(){function a(i,f,e){var w,a,b,p,nt;if(i.data[0][1]!=0){w=t.legend.labelFormatter;b=t.series.pie.label.formatter;a=w?w(i.label,i):i.label;b&&(a=b(a,i));var k=(f+i.angle+f)/2,d=u+Math.round(Math.cos(k)*r),g=h+Math.round(Math.sin(k)*r)*t.series.pie.tilt,tt='<span class="pieLabel" id="pieLabel'+e+'" style="position:absolute;top:'+g+"px;left:"+d+'px;">'+a+"<\/span>";s.append(tt);var c=s.children("#pieLabel"+e),v=g-c.height()/2,y=d-c.width()/2;c.css("top",v);c.css("left",y);(0-v>0||0-y>0||o.height-(v+c.height())<0||o.width-(y+c.width())<0)&&(l=!0);t.series.pie.label.background.opacity!=0&&(p=t.series.pie.label.background.color,p==null&&(p=i.color),nt="top:"+v+"px;left:"+y+"px;",n('<div class="pieLabelBackground" style="position:absolute;width:'+c.width()+"px;height:"+c.height()+"px;"+nt+"background-color:"+p+';"> <\/div>').insertBefore(c).css("opacity",t.series.pie.label.background.opacity))}}for(var c=startAngle,r=t.series.pie.label.radius>1?t.series.pie.label.radius:f*t.series.pie.label.radius,i=0;i<e.length;++i)e[i].percent>=t.series.pie.label.threshold*100&&a(e[i],c,i),c+=e[i].angle}var c,r,i;for(startAngle=Math.PI*t.series.pie.startAngle,c=t.series.pie.radius>1?t.series.pie.radius:f*t.series.pie.radius,ctx.save(),ctx.translate(u,h),ctx.scale(1,t.series.pie.tilt),ctx.save(),r=startAngle,i=0;i<e.length;++i)e[i].startAngle=r,a(e[i].angle,e[i].color,!0);for(ctx.restore(),ctx.save(),ctx.lineWidth=t.series.pie.stroke.width,r=startAngle,i=0;i<e.length;++i)a(e[i].angle,t.series.pie.stroke.color,!1);ctx.restore();w(ctx);t.series.pie.label.show&&v();ctx.restore()}if(s){ctx=r;rt();for(var e=i.getData(),c=0;l&&c<v;)l=!1,c>0&&(f*=d),c+=1,a(),t.series.pie.tilt<=.8&&y(),p();c>=v&&(a(),s.prepend('<div class="error">Could not draw pie with labels contained inside canvas<\/div>'));i.setSeries&&i.insertLegend&&(i.setSeries(e),i.insertLegend())}}function w(n){t.series.pie.innerRadius>0&&(n.save(),innerRadius=t.series.pie.innerRadius>1?t.series.pie.innerRadius:f*t.series.pie.innerRadius,n.globalCompositeOperation="destination-out",n.beginPath(),n.fillStyle=t.series.pie.stroke.color,n.arc(0,0,innerRadius,0,Math.PI*2,!1),n.fill(),n.closePath(),n.restore(),n.save(),n.beginPath(),n.strokeStyle=t.series.pie.stroke.color,n.arc(0,0,innerRadius,0,Math.PI*2,!1),n.stroke(),n.closePath(),n.restore())}function ot(n,t){for(var u=!1,i=-1,f=n.length,r=f-1;++i<f;r=i)(n[i][1]<=t[1]&&t[1]<n[r][1]||n[r][1]<=t[1]&&t[1]<n[i][1])&&t[0]<(n[r][0]-n[i][0])*(t[1]-n[i][1])/(n[r][1]-n[i][1])+n[i][0]&&(u=!u);return u}function st(n,t){for(var i,c=r.getData(),s=r.getOptions(),e=s.series.pie.radius>1?s.series.pie.radius:f*s.series.pie.radius,o=0;o<c.length;++o)if(i=c[o],i.pie.show){if(ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.arc(0,0,e,i.startAngle,i.startAngle+i.angle,!1),ctx.closePath(),x=n-u,y=t-h,ctx.isPointInPath){if(ctx.isPointInPath(n-u,t-h))return ctx.restore(),{datapoint:[i.percent,i.data],dataIndex:0,series:i,seriesIndex:o}}else if(p1X=e*Math.cos(i.startAngle),p1Y=e*Math.sin(i.startAngle),p2X=e*Math.cos(i.startAngle+i.angle/4),p2Y=e*Math.sin(i.startAngle+i.angle/4),p3X=e*Math.cos(i.startAngle+i.angle/2),p3Y=e*Math.sin(i.startAngle+i.angle/2),p4X=e*Math.cos(i.startAngle+i.angle/1.5),p4Y=e*Math.sin(i.startAngle+i.angle/1.5),p5X=e*Math.cos(i.startAngle+i.angle),p5Y=e*Math.sin(i.startAngle+i.angle),arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]],arrPoint=[x,y],ot(arrPoly,arrPoint))return ctx.restore(),{datapoint:[i.percent,i.data],dataIndex:0,series:i,seriesIndex:o};ctx.restore()}return null}function ht(n){b("plothover",n)}function ct(n){b("plotclick",n)}function b(n,i){var h=r.offset(),l=parseInt(i.pageX-h.left),a=parseInt(i.pageY-h.top),u=st(l,a),f,o,c;if(t.grid.autoHighlight)for(f=0;f<e.length;++f)o=e[f],o.auto!=n||u&&o.series==u.series||at(o.series);u&&lt(u.series,n);c={pageX:i.pageX,pageY:i.pageY};s.trigger(n,[c,u])}function lt(n,t){typeof n=="number"&&(n=series[n]);var i=k(n);i==-1?(e.push({series:n,auto:t}),r.triggerRedrawOverlay()):t||(e[i].auto=!1)}function at(n){n==null&&(e=[],r.triggerRedrawOverlay());typeof n=="number"&&(n=series[n]);var t=k(n);t!=-1&&(e.splice(t,1),r.triggerRedrawOverlay())}function k(n){for(var i,t=0;t<e.length;++t)if(i=e[t],i.series==n)return t;return-1}function vt(n,t){function s(n){n.angle<0||(t.fillStyle="rgba(255, 255, 255, "+r.series.pie.highlight.opacity+")",t.beginPath(),Math.abs(n.angle-Math.PI*2)>1e-9&&t.moveTo(0,0),t.arc(0,0,o,n.startAngle,n.startAngle+n.angle,!1),t.closePath(),t.fill())}var r=n.getOptions(),o=r.series.pie.radius>1?r.series.pie.radius:f*r.series.pie.radius;for(t.save(),t.translate(u,h),t.scale(1,r.series.pie.tilt),i=0;i<e.length;++i)s(e[i].series);w(t);t.restore()}var o=null,s=null,f=null,u=null,h=null,c=0,l=!0,v=10,d=.95,a=0,p=!1,e=[];r.hooks.processOptions.push(g);r.hooks.bindEvents.push(nt)}var t={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:3/2,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(n,t){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+t.color+';">'+n+"<br/>"+Math.round(t.percent)+"%<\/div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};n.plot.plugins.push({init:r,options:t,name:"pie",version:"1.0"})})(jQuery);
/*
//# sourceMappingURL=jquery.flot.pie.min.js.map
*/